 <center>
  ## 数据库  
  </center>

---

### mysql-connector 驱动

+ 使用 pip 命令来安装 mysql-connector：python -m pip install mysql-connector
+ 检测是否安装成功，import mysql.connector 不报错表示安装成功
    

	    注意：如果你的 MySQL 是 8.0 版本，密码插件验证方式发生了变化，早期版本为 mysql_native_password，8.0 版本为 caching_sha2_password，所以需要做些改变：
	    先修改 my.ini 配置：[mysqld]default_authentication_plugin=mysql_native_password

----

+ 创建数据库连接

	
 
        mydb = mysql.connector.connect(
        host="localhost",       # 数据库主机地址
        user="yourusername",    # 数据库用户名
        passwd="yourpassword"   # 数据库密码
        )
        
---

 + 创建数据库
	 
	 
	  mydb = mysql.connector.connect(
          host="localhost",
	      user="root",
	      passwd="123456"
	)
 
	mycursor = mydb.cursor()
	
	 #
	mycursor.execute("CREATE DATABASE runoob_db")

---
+ 创建表

		 mydb = mysql.connector.connect(
	      host="localhost",
		  user="root",
		  passwd="123456",
		  database="runoob_db"#知名数据库的名称
		)
		mycursor = mydb.cursor()
	 
		mycursor.execute("CREATE TABLE sites (name VARCHAR(255), url VARCHAR(255))")

---

+ 批量导入
	
			  sql = "INSERT INTO sites (name, url) VALUES (%s, %s)"
		#批量数据
		val = [
		  ('Google', 'https://www.google.com'),
		  ('Github', 'https://www.github.com'),
		  ('Taobao', 'https://www.taobao.com'),
		  ('stackoverflow', 'https://www.stackoverflow.com/')
		]
		 
		mycursor.executemany(sql, val)
		 
		mydb.commit()    # 数据表内容有更新，必须使用到该语句
	 
---

+ 查询数据
	
		mycursor.execute("SELECT * FROM sites")
 
		myresult = mycursor.fetchall()     # fetchall() 获取所有记录
		 
		for x in myresult:
		  print(x)
		  
		 
	  如果我们只想读取一条数据，可以使用 fetchone() 方法

----

+ where 模糊查询

		#模糊查询
		
		sql = "SELECT * FROM sites WHERE url LIKE '%oo%'"
	 
		mycursor.execute(sql)
	 
		myresult = mycursor.fetchall()
	 
		for x in myresult:
		  print(x)


---

+ 防止数据库查询发生 SQL 注入的攻击，我们可以使用 %s 占位符来转义查询的条件 
	
	  sql = "SELECT * FROM sites WHERE name = %s"
	  na = ("RUNOOB", )
	 
	  mycursor.execute(sql, na)
	 
	  myresult = mycursor.fetchall()
	 
	  for x in myresult:
	    print(x)
	
	  #这是有效的，正确方式
	  cur.execute('select * from table where col=%s',(param,))

      #这是无效的,只是普通的占位符替换
      cur.execute('select * from table where col=%s'% (param,))

---

+ 排序
	+ 默认升序
		+ sql = "SELECT * FROM sites ORDER BY name"
	+ 降序
		+ sql = "SELECT * FROM sites ORDER BY name DESC"
		+ 
---
+ limit 
	+ 限制查询数量limit  sql = "SELECT * FROM sites limit 3

---
+ OFFSET 制定开始读取位置 从0开始
	+ select *from sites limit 3 offset 1 #从第二位开始查询

---

+ 删除记录

		 #防止sql注入删除 通过通配符删除数据
		sql = "DELETE FROM sites WHERE name = %s"
		na = ("stackoverflow", )
		 
		mycursor.execute(sql, na)
		 
		mydb.commit()
		 
		print(mycursor.rowcount, " 条记录删除")

+ 更新数据

		  #防止sql注入删除 通过通配符删除数据
		sql = "UPDATE sites SET name = %s WHERE name = %s"
		val = ("Zhihu", "ZH")
		 
		mycursor.execute(sql, val)
		 
		mydb.commit()		


 

----------

### pymysql

+ 连接数据库前，请先确认以下事项：

	+ 您已经创建了数据库 TESTDB.
	+ 在TESTDB数据库中您已经创建了表 EMPLOYEE
  + EMPLOYEE表字段为 FIRST_NAME, LAST_NAME, AGE, SEX 和 INCOME。
  + 连接数据库TESTDB使用的用户名为 "testuser" ，密码为 "test123",你可以可以自己设定或者直接使用root用户名及其密码，Mysql数据库用户授权请使用Grant命令。
 
 ---
+ 连接方式

		import pymysql
	 
		#创建链接
		db= pymysql.connect(host="localhost",user="root",
		password="password", db="leanperlife")
		#使用 cursor() 方法创建一个游标对象 cursor
		cursor = db.cursor()
		#执行的sql 防止注入
		sql = "SELECT * FROM sites WHERE name = %s"
		na = ("RUNOOB",)
		
		cursor.execute(sql, na)













































































































