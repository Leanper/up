# 文件处理



### Json处理

![image-20210701111930491](C:\Users\ZX50J\AppData\Roaming\Typora\typora-user-images\image-20210701111930491.png)



Python 编码为 JSON 类型转换对应表：

<table style="width:658px;" cellspacing="0" cellpadding="0" border="1"><tbody><tr><td style="width:384px;">Python</td><td style="width:271px;">JSON</td></tr><tr><td style="width:384px;">dict</td><td style="width:271px;">object</td></tr><tr><td style="width:384px;">list, tuple</td><td style="width:271px;">array</td></tr><tr><td style="width:384px;">str</td><td style="width:271px;">string</td></tr><tr><td style="width:384px;">int, float, int- &amp; float-derived Enums</td><td style="width:271px;">number</td></tr><tr><td style="width:384px;">True</td><td style="width:271px;">true</td></tr><tr><td style="width:384px;">False</td><td style="width:271px;">false</td></tr><tr><td style="width:384px;">None</td><td style="width:271px;">null</td></tr></tbody></table>

JSON 解析为python 类型转换对应表：

<table style="width:663px;" cellspacing="0" cellpadding="0" border="1"><tbody><tr><td style="width:389px;">JSON</td><td style="width:271px;">Python</td></tr><tr><td style="width:389px;">object</td><td style="width:271px;">dict</td></tr><tr><td style="width:389px;">array</td><td style="width:271px;">list</td></tr><tr><td style="width:389px;">string</td><td style="width:271px;">str</td></tr><tr><td style="width:389px;">number (int)</td><td style="width:271px;">int</td></tr><tr><td style="width:389px;">number (real)</td><td style="width:271px;">float</td></tr><tr><td style="width:389px;">true</td><td style="width:271px;">True</td></tr><tr><td style="width:389px;">false</td><td style="width:271px;">False</td></tr><tr><td style="width:389px;">null</td><td style="width:271px;">None</td></tr></tbody></table>





```
import json
str ="""
{
    "homeadlist": [
        {
            "id": 1,
            "imgurl": "/img/homead/a73b3f1d-0f14-429d-9d0f-70643fb0f0eb.jpg",
            "jumpflag": 0,
            "jumpurl": "",
            "posflag": 1,
            "remark": "1111",
            "cityid": 1
        },
        {
            "id": 12,
            "imgurl": "/img/homead/eb442fbf-49db-4ba6-a102-d781505f426d.jpg",
            "jumpflag": 0,
            "jumpurl": "",
            "posflag": 2,
            "remark": "",
            "cityid": 1
        },
        {
            "id": 14,
            "imgurl": "/img/homead/68109460-635d-4c5c-8be8-64d7c7889d18.jpg",
            "jumpflag": 0,
            "jumpurl": "http://shiranlife.kuaizhan.com/",
            "posflag": 4,
            "remark": "",
            "cityid": 1
        }
    ]
}

"""
# json转为对象
json_data = json.loads(str)
print('这是文件中的json数据：', json_data)
print('这是读取到文件数据的数据类型：', type(json_data))
print(json_data['homeadlist'])

for a in json_data['homeadlist']:
    print(a['posflag'])

# 对象转为字符串
info = json.dumps(json_data)
print(info)
```







### 2 Excel处理

#### 	2.1 openpyxl对Excel的操作

- 创建一个工作薄：wb = openpyxl.Workbook()

- 新增一个sheet表单：wb.create_sheet('test_case')

- 保存case.xlsx文件：wb.save('cases.xlsx')

- 打开工作簿：wb = openpyxl.load_workbook('cases.xlsx')

- 选取表单：sh = wb['Sheet1']

- 读取第一行、第一列的数据：ce = sh.cell(row = 1,column = 1)

- 按行读取数据：row_data = list(sh.rows)

- 关闭工作薄：wb.close()

- 按列读取数据：columns_data = list(sh.columns)

- **写入数据之前，该文件一定要处于关闭状态**

- 写入第一行、第四列的数据 value = 'result'：sh.cell(row = 1,column = 4,value = 'result')

- 获取最大行总数、最大列总数：sh.max_row、sh.max_column

- del 删除表单的用法：del wb['sheet_name'] 

- remove 删除表单的用法：sh = wb['sheet_name'] wb.remove(sh) 

- append在最后面拼接信息

- ```
  sheet.append([5, '张三', '0', 90, '二班'])
  ```

  

```
# 获取制定数据
for cell in sheet["B2:B5"]:
    print(cell[0].value)
# 便利数据
for cell in sheet:
    for row in cell:
        print(row.value, end=',')
    print()

# 制定几行
print("按列循环--制定几行")
for cell in sheet.iter_rows(min_col=2, max_col=4, max_row=3):
    for c in cell:
        print(c.value)



print("按列循环")
# 按列循环
for cell in sheet.columns:
    for c in cell:
        print(c.value)
    print()

# 制定几行
print("按列循环--制定几行")
for cell in sheet.iter_cols(min_col=2, max_col=4, max_row=3):
    for c in cell:
        print(c.value)

# 修改内容
sheet["B3"] = "修改了"
wb.save("studyexcel.xlsx")
```



#### 2.2 设置样式

- **修改样式要调用save保存**

- 通过styles导入各种样式、 from openpyxl.styles import Font, Alignment, colors, PatternFill 其中包括

  - Font

    - 设置字体 大小颜色 字体 粗细

      ```
      text_font = Font(name="楷体", color="FF0000", italic=True)
      sheet["B4"].font = text_font
      wb.save()
      ```

  - Alignment

    - 设置边距

    - ```
      # alignment 参数 水平垂直居中 文本旋转角度  wrap_text=是否自动换行
      # 水平对齐：
      # horizontal代表水平方向，可以左对齐left，还有居中center和右对齐right，分散对齐distributed，跨列居中centerContinuous，两端对齐justify，填充fill，常规general
      # 垂直对齐：
      # vertical代表垂直方向，可以居中center，还可以靠上top，靠下bottom，两端对齐justify，分散对齐distributed
      
      alignment = Alignment(horizontal="center", vertical="center", text_rotation=45, wrap_text=True)
      ```

    - 

  - fills

    ```
    # 背景设置
    # PatternFill(fill_type=填充样式，fgColor=填充颜色）
    # GradientFill(stop=(渐变颜色 1，渐变颜色 2……))
    pattern_fill = PatternFill(fill_type="solid", fgColor="99ccff")
    sheet["E2"].fill = pattern_fill
    gradient_fill = GradientFill(stop=("FFFFFF", "99ccff", "000000"))
    sheet["E3"].fill = gradient_fill
    ```

  - Color

  - borders

    - Border

    - ```python
      border = Border(left=thin, right=thin, top=thin, bottom=thin)#边框的位置
      ```

    - Side

      - ```
        # 设置边框样式 Side(style，color)
        #  style 参数的种类： 'double, 'mediumDashDotDot', 'slantDashDot', 
        # 'dashDotDot','dotted','hair', 'mediumDashed, 'dashed', 'dashDot', 'thin', 
        # 'mediumDashDot','medium', 'thick'
        
        side1 = Side(style="thin", color="FF0000")
        side2 = Side(style="thick", color="FFFF0000")
        border = Border(left=side1, right=side1, top=side2, bottom=side2)
        sheet["E1"].border = border
        ```

  - named_styles

  - protection

  - numbers

  - 设置宽高

    - ```python
      # 设置第 1 行的高度
      sheet.row_dimensions[1].height = 50
      # 设置 B 列的宽度
      sheet.column_dimensions["B"].width = 20
      
      # 将整个表的行高设置为 50，列宽设置为 30；
      sheet.row_dimensions.height = 50 
      sheet.column_dimensions.width = 30 
      ```

  

  - 合并单元格

    ```
    .merge_cells(待合并的格子编号)
    .merge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，end_column=结束列号)
    ```



### 3.0 file





